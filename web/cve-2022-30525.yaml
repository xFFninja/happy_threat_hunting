title: Zyxel Firewall Unauthenticated Remote Command Injection [CVE-2022-30525]
description: Detects CVE-2022-30525 probing or exploitation attempts
id: 51cf26ab-6438-47ea-8e3c-8df24e68c9d3
status: stable
references:
  - https://www.rapid7.com/blog/post/2022/05/12/cve-2022-30525-fixed-zyxel-firewall-unauthenticated-remote-command-injection/
author: xffninja
date: 2022/05/13
tags:
  - attack.initial_access
  - attack.t1090
logsource:
  product: proxy
detection:
  selection:
    cs-method: 'POST'
    c-uri|contains: 
      - 'ztp/cgi-bin/handler'
    http-request-body|contains|all:
      - 'setWanPortSt'
      - 'mtu'
    http-request-body|re: 'mtu["']\s*:\s*["']\s*((?!\d+).*?),'
  condition: selection
level: high